(()=>{"use strict";var e={958:e=>{var r={isMobile:e=>{try{const r=e?.type||null;return e&&r?"mobile"===r.slice(0,6):(console.warn("kchelper isMobile: Failed to get kintone event type. Return default value (false)."),!1)}catch(e){console.error(`kchelper isMobile: ${e}`)}}},t={getFieldElement:(e,r)=>{try{return!0===r?kintone.mobile.app.record.getFieldElement(e):kintone.app.record.getFieldElement(e)}catch(e){console.error(`kchelper getFieldElement: ${e}`)}},getFieldElements:(e,r)=>{try{return!0===r?kintone.mobile.app.getFieldElements(e):kintone.app.getFieldElements(e)}catch(e){console.error(`kchelper getFieldElements: ${e}`)}}},o={getRecord:e=>{try{return!0===e?kintone.mobile.app.record.get().record:kintone.app.record.get().record}catch(e){console.error(`kchelper getRecord: ${e}`)}},setRecord:(e,r)=>{try{return!0===r?kintone.mobile.app.record.set({record:e}):kintone.app.record.set({record:e})}catch(e){console.error(`kchelper setRecord: ${e}`)}}};const{isMobile:c}=r,{getFieldElement:n,getFieldElements:i}=t,{getRecord:a,setRecord:d}=o;var l={isMobile:c,getFieldElement:n,getFieldElements:i,getSpaceElement:(e,r)=>{try{return!0===r?kintone.mobile.app.record.getSpaceElement(e):kintone.app.record.getSpaceElement(e)}catch(e){console.error(`kchelper getSpaceElement: ${e}`)}},getDateString:(e,r=new Date)=>{try{const t=r.getFullYear().toString(),o=(r.getMonth()+1).toString().padStart(2,"0"),c=r.getDate().toString().padStart(2,"0");let n;switch(e){case"yyyymmdd":default:n=`${t}${o}${c}`;break;case"yymmdd":n=`${t.slice(2,4)}${o}${c}`;break;case"yyyy-mm-dd":n=`${t}-${o}-${c}`;break;case"yyyymm":n=`${t}${o}`;break;case"yymm":n=`${t.slice(2,4)}${o}`}return n}catch(e){console.error(`kchelper getDateString: ${err}`)}},hideField:(e,r)=>{try{return!0===r?kintone.mobile.app.record.setFieldShown(e,!1):kintone.app.record.setFieldShown(e,!1)}catch(e){console.error(`kchelper hideField: ${e}`)}},getRecord:a,setRecord:d};e.exports=l}},r={};function t(o){var c=r[o];if(void 0!==c)return c.exports;var n=r[o]={exports:{}};return e[o](n,n.exports,t),n.exports}(()=>{const e="系列序號",r="商品系列",o="原商品系列";var c=t(958);kintone.events.on(["app.record.create.show","app.record.edit.show","app.record.index.edit.show","mobile.app.record.create.show","mobile.app.record.edit.show"],(e=>(["商品型號","系列序號","原商品系列"].forEach((r=>{e.record[r].disabled=!0})),e))),kintone.events.on(["app.record.detail.show","app.record.create.show","app.record.edit.show","mobile.app.record.detail.show","mobile.app.record.create.show","mobile.app.record.edit.show"],(e=>(["原商品系列"].forEach((r=>{(0,c.hideField)(r,(0,c.isMobile)(e))})),e))),kintone.events.on(["app.record.create.submit","app.record.edit.submit","app.record.create.submit.success","app.record.edit.submit.success"],(async t=>{try{const{record:c}=t,n=c[r].value;if(n===c[o].value)return t;if("app.record.create.submit"===t.type||"app.record.edit.submit"===t.type){const t=(r=>r?(Number(r[e].value)+1).toString().padStart(4,"0"):"0001")(await(async t=>{if(!t)return;const o=kintone.api.url("/k/v1/records"),c={app:48,query:`\n      ${r} in ("${t}")\n      order by ${e} desc limit 1\n    `};return(await kintone.api(o,"GET",c)).records[0]||null})(n)),o=`${n}${t}`;c[e].value=t,c["商品型號"].value=o}if("app.record.create.submit.success"===t.type||"app.record.edit.submit.success"===t.type){const e={};e[o]={type:"SINGLE_LINE_TEXT",value:n};const r={app:48,id:t.record.$id.value,record:e};await kintone.api(kintone.api.url("/k/v1/record"),"PUT",r)}return t}catch(e){console.error(e)}}))})()})();