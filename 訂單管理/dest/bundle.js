(()=>{"use strict";var e={958:e=>{var t={isMobile:e=>{const{type:t}=e;return"mobile"===t.slice(0,6)}};const{isMobile:r}=t;var n={getFieldElement:(e,t)=>r(e)?kintone.mobile.app.record.getFieldElement(t):kintone.app.record.getFieldElement(t),getFieldElements:(e,t)=>r(e)?kintone.mobile.app.getFieldElements(t):kintone.app.getFieldElements(t)};const{isMobile:o}=t,{isMobile:a}=t,{getFieldElement:i,getFieldElements:c}=n;var d={isMobile:a,getFieldElement:i,getFieldElements:c,getSpaceElement:(e,t)=>o(e)?kintone.mobile.app.record.getSpaceElement(t):kintone.app.record.getSpaceElement(t),getDateString:(e,t=new Date)=>{const r=t.getFullYear().toString(),n=(t.getMonth()+1).toString().padStart(2,"0"),o=t.getDate().toString().padStart(2,"0");let a;switch(e){case"yyyymmdd":default:a=`${r}${n}${o}`;break;case"yymmdd":a=`${r.slice(2,4)}${n}${o}`;break;case"yyyy-mm-dd":a=`${r}-${n}-${o}`;break;case"yyyymm":a=`${r}${n}`;break;case"yymm":a=`${r.slice(2,4)}${n}`}return a}};e.exports=d}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,r),a.exports}(()=>{var e=r(958);const t="商品型號",n="訂單明細",o="訂單明細商品名稱",a="訂單明細商品型號",i="訂單明細單價",c="訂單明細數量",d="訂單明細金額小計",l=["app.record.create.show","app.record.edit.show","mobile.app.record.create.show","mobile.app.record.edit.show"],p=r=>{try{kintone.app.record.setFieldShown(t,!1),kintone.mobile.app.record.setFieldShown(t,!1);const l=(0,e.getSpaceElement)(r,"add-btn"),p=new Kuc.Button({text:"Add",type:"submit",id:"add-button"});return l.appendChild(p),p.addEventListener("click",(e=>{const r=kintone.app.record.get().record,l=r[t],p=r["商品名稱"],s=r["商品售價"],u=r["數量"];if(!l.value||!p.value||!s.value){const e="請輸入商品資訊";throw new Kuc.Notification({text:e,type:"danger",duration:2e3}).open(),new Error(e)}if(!u.value){const e="請輸入數量";throw new Kuc.Notification({text:e,type:"danger",duration:2e3}).open(),new Error(e)}const m={value:{}};m.value[a]=l,m.value[o]=p,m.value[i]=s,m.value[c]=u,m.value[d]={type:"CALC",value:Number(s.value)*Number(u.value)},r[n].value[0].value[a].value||r[n].value.shift(),r[n].value.push(m),kintone.app.record.set({record:r})})),r}catch(e){return console.err(e),r}},s=["商品名稱","商品型號","商品售價","數量"],u=["app.record.detail.show","mobile.app.record.detail.show"],m=e=>(s.forEach((e=>{kintone.app.record.setFieldShown(e,!1),kintone.mobile.app.record.setFieldShown(e,!1)})),e),v=async e=>{try{const t=kintone.api.url("/k/v1/records"),r=await kintone.api(t,"GET",e),{records:n}=r;return n}catch(e){console.error(e)}},g=(e,t)=>{if(!t)throw new Error('getFieldValueArray: params "fieldCode" is required');if(!e||0===e.length)throw new Error('getFieldValueArray: params "records" cannot be an empty array');return e.map((e=>e[t].value))},y=(e,t="Dropdown")=>({label:t,items:e.map((e=>({label:e,value:e})))}),w="商品系列",h="商品型號",b="商品名稱",k={series:{app:50,query:`\n      啟用狀態 in ("啟用")\n      order by ${w} asc\n    `},product:{app:48}},E=["app.record.create.show","app.record.edit.show"],$=async t=>{try{const r=await v(k.series),n=g(r,w),o=y(n,"選擇商品系列"),a=new Kuc.Dropdown(o),i=(0,e.getSpaceElement)(t,"product-series"),c=(0,e.getSpaceElement)(t,"product-id");return i.appendChild(a),a.addEventListener("change",(async e=>{const t=e.target.value;k.product.query=`\n          ${w} in ("${t}")\n          order by ${h} asc\n        `;const r=await v(k.product),n=g(r,h),o=y(n,"選擇商品型號"),a=new Kuc.Dropdown(o);c.innerHTML="",c.appendChild(a),a.addEventListener("change",(async e=>{const t=e.target.value;k.product.query=`\n            ${h} = "${t}"\n          `;const r=(await v(k.product))[0][b].value,n=kintone.app.record.get();n.record[b].value=r,n.record[b].lookup=!0,kintone.app.record.set(n)}))})),t}catch(e){return console.error(e),t.error="Something wrong!",t}};Kucs["1.17.0"],kintone.events.on(E,$),kintone.events.on(l,p),kintone.events.on(u,m)})()})();